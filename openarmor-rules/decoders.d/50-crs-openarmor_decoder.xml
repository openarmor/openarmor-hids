<!-- openarmor decoder.
       - Deals with openarmor internal messages.
  -->
<decoder name="openarmor">
  <prematch_pcre2>^openarmor: </prematch_pcre2>
  <type>openarmor</type>
</decoder>

<decoder name="openarmor-logcollector">
  <type>openarmor</type>
  <prematch_pcre2>^\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2} openarmor-logcollector</prematch_pcre2>
  <pcre2 offset="after_prematch">^\(\d+?\): (.)</pcre2>
  <order>extra_data</order>
</decoder>

<decoder name="openarmor-agent">
  <parent>openarmor</parent>
  <type>openarmor</type>
  <prematch_pcre2 offset="after_parent">^Agent started:</prematch_pcre2>
  <pcre2 offset="after_prematch">^ '(\S+\S)'</pcre2>
  <order>extra_data</order>
  <fts>name, location, extra_data</fts>
</decoder>

<decoder name="openarmor-alert1">
   <parent>openarmor</parent>
   <prematch_pcre2>^openarmor: Alert Level:</prematch_pcre2>
   <plugin_decoder>openarmorAlert_Decoder</plugin_decoder>
</decoder>

<decoder name="openarmor-alert">
  <program_name_pcre2>^openarmor$</program_name_pcre2>
  <plugin_decoder>openarmorAlert_Decoder</plugin_decoder>
</decoder>


<!-- decoder for active responses as logged by an openarmor agent or server

- Examples
Sat May  7 03:17:27 CDT 2011 /var/openarmor/active-response/bin/host-deny.sh add - 172.16.0.1 1304756247.60385 31151
Sat May  7 03:17:27 CDT 2011 /var/openarmor/active-response/bin/firewall-drop.sh add - 172.16.0.1 1304756247.60385 31151
Sat May  7 03:27:57 CDT 2011 /var/openarmor/active-response/bin/host-deny.sh delete - 172.16.0.1 1304756247.60385 31151
Sat May  7 03:27:57 CDT 2011 /var/openarmor/active-response/bin/firewall-drop.sh delete - 172.16.0.1 1304756247.60385 31151
-->

<decoder name="ar_log">
  <prematch_pcre2>^[A-Za-z0-9@_-]{3} [A-Za-z0-9@_-]+?[ ]+?\d+? \d{2}:\d{2}:\d{2} [A-Za-z0-9@_-]+? \d+? /\S+/active-response</prematch_pcre2>
  <pcre2 offset="after_prematch">/bin/(\S+) (\S+) - (\S+) (\d+?\.\d+?) (\d+)</pcre2>
  <order>action, status, srcip, id, extra_data</order>
</decoder>


